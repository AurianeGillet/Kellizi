<div class="container-fluid gradient">
  <div class="container panel-default">
    <h1>My contracts</h1>
  </div>
</div>
<div class="container">
  <div class="d-flex", style= "justify-content: space-between">

  <div class="container">
    <div class="row">
      <%= link_to "Back", "/dashboard", class:"btn-gray", style:"width: 200px;" %>
    </div>
  </div>
    <%= link_to "New Contract", new_contract_path, class: "btn-grad-light" %>
  </div>
  <div class="nav-search mt-4">
    <div class="search">
      <%= form_with url: contracts_path, method: :get, class: "d-flex" do %>
        <%= text_field_tag :query,
          params[:query],
          class: "form-control",
          placeholder: "Look for a Contract"
        %>
        <%= hidden_field_tag :category, params[:category] %>
        <%= button_tag "Search", class: "btn-gray" %>
      <% end %>
    </div>

    <% @contracts.each do |contract| %>
      <div class="insurance-card p-2">
      <%= link_to "", contract_path(contract), class: "fa-solid fa-trash-can", data: {turbo_method: :delete, turbo_confirm: "Are you sure you want to delete this contract?"} %>
        <%= link_to contract_path(contract), class:"link-contract" do %>
        <div class="row">
          <div class="col-3 d-flex">
            <div class="logo">
              <%= cl_image_tag contract.company.logo.key, class:"insurance-logo", style: "width: 100%; background: white; padding:5px" %>
            </div>
          </div>
          <div class="col-6">
            <h1><%= contract.product.category.name %> - <%= contract.product.name %></h1>
            <h2><%= contract.product.company.name %></h2>
            <h2><%= contract.price %> â‚¬/month</h2>
          </div>
          <div class="col-3">
            <% if contract.active %>
              <h3 class="rounded-border pink mx-3">Status: Active</h3>
            <% else %>
              <h3 class="rounded-border gray mx-3">Status: Inactive</h3>
            <% end %>
            <h3 class="rounded-border mx-3">Starts at: <%= contract.starts_at.strftime('%d/%b/%Y') %></h3>
            <h3 class="rounded-border mx-3">Ends at: <%= contract.ends_at&.strftime('%d/%b/%Y') %></h3>

            <% if contract.source %>
            <h3 class="rounded-border mx-3">Contract source: <%= contract.source %></h3>
            <% end %>
            <% unless contract.pdf_contract.attached? %>
            <p class="rounded-border mx-3 warning-color">Warning no pdf contract</p>
            <% end %>
          </div>
        </div>
        <% end %>
      </div>
    <% end %>
  </div>
  <br>
</div>
